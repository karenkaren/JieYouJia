//
//  ViewController.m
//  LingTouNiaoZF
//
//  Created by LiuFeifei on 16/10/24.
//  Copyright © 2016年 LiuJie. All rights reserved.
//

#import "ViewController.h"
#import "BaseNavigationController.h"
#import "NetAddressSettingController.h"

@interface ViewController ()<UITableViewDataSource, UITableViewDelegate>

@property (nonatomic, strong) UITableView * tableView;
@property (nonatomic, strong) UIImageView * iv;
@property (nonatomic, strong) UISearchBar * searchBar;

@end

@implementation ViewController

//- (void)viewDidLoad {
//    [super viewDidLoad];
//    if ([self.navigationController isKindOfClass:[BaseNavigationController class]]) {
//        BaseNavigationController * base = (BaseNavigationController *)self.navigationController;
//        //base.barBackgroundColor = [UIColor orangeColor];
//        base.borderColor = [UIColor blackColor];
//    }
//
//    DLog(@"%@", API_BASE_URL);
//    NSDictionary * dic = @{@"clientType" : @"I", @"currentPage" : @0, @"pageSize" : @10};
//    [[NetAPIManager sharedNetAPIManager] requestWithPath:@"https://www.lingtouniao.com/v3/product/lists" params:dic methodType:Get block:^(id response, NSError *error) {
//        NSDictionary * dic = nil;
//        if (dic) {
//            if ([dic count] > 0) {
//                DLog(@"有值了");
//            } else {
//                [self showDataEmptyView];
//            }
//        } else {
//            [self showErrorView];
//        }
//    }];
//}
//
//- (void)touchNetFailView:(UIView *)view
//{
//    [super touchNetFailView:view];
//    DLog(@"又开始刷新了");
//}

- (void)viewDidLoad
{
    [super viewDidLoad];
    
    [self showCloseButton];
    
    self.title = @"你好";
//    UISearchBar * searchBar = [[UISearchBar alloc] initWithFrame:self.navigationController.navigationBar.bounds];
//    searchBar.placeholder = @"你想查找什么？";
//    [searchBar setImage:[UIImage imageNamed:@"nav_close"] forSearchBarIcon:UISearchBarIconResultsList state:UIControlStateNormal];
//    self.navigationItem.titleView = searchBar;
//    self.searchBar = searchBar;
    
    
//    UITextField * tf = [[UITextField alloc] initWithFrame:self.navigationController.navigationBar.bounds];
//    tf.borderStyle = UITextBorderStyleRoundedRect;
//    tf.leftView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"nav_return"]];
//    tf.leftViewMode = UITextFieldViewModeAlways;
//    tf.placeholder = @"你想查找什么？";
//    self.navigationItem.titleView = tf;
    
    self.navigationItem.rightBarButtonItem = [UIBarButtonItem barItemWithImage:[UIImage imageNamed:@"nav_return"] target:self action:@selector(back)];
    
    [self setTableView];
    [self registerCell];
}

- (void)setTableView
{
    _tableView = [[UITableView alloc]initWithFrame:CGRectMake(0, 0, kScreenWidth, kScreenHeight - kNavigationBarHeight  - kStatusBarHeight) style:UITableViewStylePlain];
        _tableView.dataSource = self;
        _tableView.delegate = self;
    [self.view addSubview:_tableView];

    UIImageView * iv = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, kScreenWidth, 200)];
    iv.contentMode = UIViewContentModeScaleAspectFill;
    iv.clipsToBounds = YES;
    iv.image = [UIImage imageNamed:@"home"];
    UIView * headerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, kScreenWidth, 200)];
    [headerView addSubview:iv];
    self.iv = iv;
    _tableView.tableHeaderView = headerView;
}

- (void)registerCell
{
    [_tableView registerClass:[UITableViewCell class] forCellReuseIdentifier:@"Cell"];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 50;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:@"Cell"];
    cell.textLabel.text = [NSString stringWithFormat:@"haha--%ld", indexPath.row];
    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NetAddressSettingController * netSettingController = [[NetAddressSettingController alloc] init];
    [self.navigationController pushViewController:netSettingController animated:YES];
}

#pragma mark 滑动隐藏导航栏

-(void)scrollViewDidScroll:(UIScrollView *)scrollView{
    //滑动隐藏导航栏，只要滑动就有效果
//    CGPoint translation = [scrollView.panGestureRecognizer translationInView:scrollView.superview];
//    [self.navigationController setNavigationBarHidden:translation.y<0 animated:YES];
//    if (translation.y<0) {
//        _tableView.frame = CGRectMake(0, kStatusBarHeight, kScreenWidth, kScreenHeight - kStatusBarHeight);
//    } else {
//        _tableView.frame = CGRectMake(0, 0, kScreenWidth, kScreenHeight - kNavigationBarHeight  - kStatusBarHeight);
//    }
//    NSLog(@"ContentOffset  x is  %f,yis %f",translation.x,translation.y);
    
    // 放大效果
    CGRect frame = self.iv.frame;
    CGFloat y = scrollView.contentOffset.y;
    frame.origin.y = y;
    frame.size.height = -y + 200;
    self.iv.frame = frame;
}


@end
